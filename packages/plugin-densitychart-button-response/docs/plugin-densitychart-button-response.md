# plugin-densitychart-button-response

## Overview

The `densitychart-button-response` plugin displays a density plot chart and records responses generated by a button click. The chart can be displayed until a response is given, or for a pre-determined amount of time. The trial can be ended automatically if the participant does not respond within a fixed length of time. The button itself can be customized using HTML formatting.

The density plot stimulus is generated from a numeric array of data, with optional parameters for customizing how smooth the densities are and the colours used. You can also add an annotation to the chart indicated by a vertical line with an accompanying text annotation.

This plugin uses [Chart.js](https://www.chartjs.org/) under the hood, and supports features like axis labeling, legend display, and percentage formatting on the y-axis.

---

## Loading (Note: these CDN resources don't currently exist... but maybe will eventually?)

Using the CDN-hosted JavaScript file:

```js
<script src="https://unpkg.com/@jspsych/plugin-densitychart-button-response@VERSION_HERE"></script>
```

Using the JavaScript file downloaded from a GitHub release dist archive:

```js
<script src="jspsych/plugin-densitychart-button-response.js"></script>
```

Using NPM:

```
npm install @jspsych/plugin-densitychart-button-response
```

```js
import jsPsychBarchartButtonresponse from "@jspsych/plugin-densitychart-button-response";
```

---

## Compatibility

- jsPsych version: **v8.0.0 or later**

---

## Parameters

| Name               | Type             | Default       | Description                                                       |
| ------------------ | ---------------- | ------------- | ----------------------------------------------------------------- |
| `description_text` | HTML string      | `undefined`   | Optional text shown above the chart for instructions or context.  |
| `chart_data`       | Array of numbers | `undefined`   | Required numeric data used to compute the density estimate.       |
| `n_grid_points`    | Integer          | `100`         | Number of grid points used to compute the density curve.          |
| `n_x_labels`       | Integer          | `5`           | Maximum number of tick marks on the x-axis.                       |
| `n_y_labels`       | Integer          | `5`           | Maximum number of tick marks on the y-axis.                       |
| `base_color`       | String (color)   | `"#02c39a80"` | Color used for the density curve and fill.                        |
| `highlight_color`  | String (color)   | `"#ff1100"`   | Color used for the vertical line annotation.                      |
| `highlight_score`  | Number           | `null`        | A numeric value to be highlighted with a vertical line and label. |
| `highlight_label`  | String           | `null`        | Text label displayed next to the highlighted value.               |
| `x_axis_label`     | String           | `""`          | Label for the x-axis.                                             |
| `y_axis_label`     | String           | `""`          | Label for the y-axis.                                             |
| `show_legend`      | Boolean          | `false`       | Whether to display a legend beside the chart.                     |
| `choices`          | Array of strings | `undefined`   | Labels for the response buttons.                                  |
| `button_html`      | Function         | _(see below)_ | Function that returns HTML for each response button.              |
| `bandwidth`        | Number           | `10`          | Bandwidth parameter used for kernel smoothing.                    |

**Default `button_html` function:**

```ts
(choice: string, choice_index: number) =>
  `<button class="jspsych-btn">${choice}</button>`;
```

---

## Data Generated

| Name       | Type    | Description                                                     |
| ---------- | ------- | --------------------------------------------------------------- |
| `rt`       | Integer | Response time in milliseconds from trial start to button click. |
| `response` | Integer | Index (0-based) of the selected button in the `choices` array.  |

---

## Example

```js
const trial = {
  type: "densitychart-button-response",
  description_text: "<p>How would you interpret this distribution?</p>",
  chart_data: [34, 36, 40, 38, 37, 41, 39, 42, 36, 35],
  highlight_score: 38,
  highlight_label: "Reference",
  base_color: "#0066cc80",
  highlight_color: "#cc3300",
  x_axis_label: "Score",
  y_axis_label: "Density",
  choices: ["Low", "Medium", "High"],
};
```

---

## Documentation

See [documentation](https://github.com/themusiclab/pose/tree/main/plugin-densitychart-button-response/README.md)

---

## Author / Citation

[Courtney B. Hilton](https://github.com/courtney-bryce-hilton)  
If you use this plugin in your research, please cite the corresponding repository or paper when available.
