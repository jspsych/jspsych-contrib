# plugin-barchart-button-response

## Overview

The `barchart-button-response` plugin displays a bar chart and records responses generated by a button click. The chart can be displayed until a response is given, or for a pre-determined amount of time. The trial can be ended automatically if the participant does not respond within a fixed length of time. The buttons themselves can be customized using HTML formatting.

The bar chart stimulus is generated from an array of objects, where each object should contain a numeric `value` (used for the y-axis) and a string `key` (used for the x-axis label). One of the bars can optionally be highlighted in a distinct color and annotated with a text label.

This plugin uses [Chart.js](https://www.chartjs.org/) under the hood, and supports features like axis labeling, legend display, and percentage formatting on the y-axis.

---

## Loading (Note: these CDN resources don't currently exist... but maybe will eventually?)

Using the CDN-hosted JavaScript file:

```js
<script src="https://unpkg.com/@jspsych/plugin-barchart-button-response@VERSION_HERE"></script>
```

Using the JavaScript file downloaded from a GitHub release dist archive:

```js
<script src="jspsych/plugin-barchart-button-response.js"></script>
```

Using NPM:

```
npm install @jspsych/plugin-barchart-button-response
```

```js
import jsPsychBarchartButtonresponse from "@jspsych/plugin-barchart-button-response";
```

## Compatibility

- jsPsych version: **v8.0.0 or later**

---

## Parameters

| Name               | Type             | Default       | Description                                                                                            |
| ------------------ | ---------------- | ------------- | ------------------------------------------------------------------------------------------------------ |
| `description_text` | HTML string      | `undefined`   | Optional text shown above the chart for instructions or context.                                       |
| `chart_data`       | Array of objects | `undefined`   | Required data for the chart. Each object must have a `key` (x-axis label) and `value` (y-axis height). |
| `base_color`       | String (color)   | `"#02c39a80"` | Color for non-highlighted bars.                                                                        |
| `highlight_value`  | String           | `undefined`   | The `key` of the bar to be visually highlighted.                                                       |
| `highlight_color`  | String (color)   | `"#fee44080"` | Color used for the highlighted bar.                                                                    |
| `highlight_label`  | String           | `undefined`   | Label text shown above the highlighted bar.                                                            |
| `x_axis_label`     | String           | `""`          | Text label for the x-axis.                                                                             |
| `y_axis_label`     | String           | `""`          | Text label for the y-axis.                                                                             |
| `y_percent`        | Boolean          | `false`       | Whether to format y-axis values as percentages (0–1 → 0–100%).                                         |
| `show_legend`      | Boolean          | `false`       | Whether to display a legend showing the highlight label.                                               |
| `choices`          | Array of strings | `undefined`   | Labels for the response buttons.                                                                       |
| `button_html`      | Function         | _(see below)_ | Function that returns HTML for each response button.                                                   |

**Default `button_html` function:**

```ts
(choice: string, choice_index: number) =>
  `<button class="jspsych-btn">${choice}</button>`;
```

---

## Data Generated

The following data is stored for each trial:

| Name       | Type    | Description                                                     |
| ---------- | ------- | --------------------------------------------------------------- |
| `rt`       | Integer | Response time in milliseconds from trial start to button click. |
| `response` | Integer | Index (0-based) of the selected button in the `choices` array.  |

---

## Example

```js
const trial = {
  type: "barchart-button-response",
  description_text: "<p>Which bar is the highest?</p>",
  chart_data: [
    { key: "A", value: 0.4 },
    { key: "B", value: 0.6 },
    { key: "C", value: 0.2 },
  ],
  highlight_value: "B",
  highlight_label: "Target",
  base_color: "#cccccc",
  highlight_color: "#ff9999",
  x_axis_label: "Category",
  y_axis_label: "Proportion",
  y_percent: true,
  show_legend: true,
  choices: ["A", "B", "C"],
};
```

---

## Notes

- If both `grid_rows` and `grid_columns` are `null` and `button_layout` is `"grid"`, an error will be thrown. One must be specified.
- The plugin currently assumes static size for the chart canvas. You can customize via CSS or extend the `createChartContainer()` logic.

---

## Author / Citation

[Courtney B. Hilton](https://github.com/courtney-bryce-hilton)  
If you use this plugin in your research, please cite the corresponding repository or paper when available.
